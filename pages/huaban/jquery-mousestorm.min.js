(function(t){t.fn.mousestorm=function(e){function a(){for(var e="",a=0;a<c.maxkey;a++){var s=n(c.opacity[0],c.opacity[1]),r=n(c.time[0],c.time[1]),i=n(c.scale[0],c.scale[1]),m=c.diepresent,p=n(c.rotate[0],c.rotate[1]),l={css:{transform:"rotate("+p+"deg) scale("+i+") translateX(0) translateY(0)",opacity:s,animation:"strom"+a+" "+r+"ms linear forwards"}},f=parseInt(n(0,360)),d=o*m*Math.sin(f*Math.PI/180),u=o*m*Math.cos(f*Math.PI/180);e+="@keyframes strom"+a+"{ 0%{transform:"+l.css.transform+"; opacity:"+s+";scale("+i+");} 100%{transform:rotate("+p+"deg) translateX("+d+"px) translateY("+u+"px) scale("+n(c.scale[0],c.scale[1])+"); opacity:0;} }.stay"+a+"{transform:"+l.css.transform+"; opacity:"+l.css.opacity+";animation:"+l.css.animation+";}"}t("#mouseStorm").append(e)}function s(e,a){var s=t("<img />"),o="stay"+parseInt(n(0,c.maxkey)),i=c.images,m={tag:s,src:i[parseInt(n(0,i.length))],css:{left:e,top:a}};s.attr({src:m.src,class:o}),s.css(m.css),r.append(s);var p=s.css("animation-duration");p=1e3*p.substr(0,p.length-1),setTimeout(function(){t(s).remove()},p)}function n(t,e){return Math.random()*(e-t)+t}if(e&&"images"in e&&e.images[0]){var o=t(window).width(),r=(t(window).height(),t(this)),i={opacity:[.2,.96],time:[2e3,3e3],rotate:[360,720],scale:[.3,.7],diepresent:.2,numpresent:.04,maxkey:1e3},c=t.extend({},i,e);t("head").append(t('<style id="mouseStorm">'+this.selector+" img{position:absolute;left:0;top:0; transform:rotate(0deg); z-index: 999;}</style>")),a(),t(window).on("mousemove",function(t){var e=t.pageX,a=t.pageY;1==parseInt(n(0,1/c.numpresent))&&s(e,a)})}else console.log("对不起，请指定粒子图片")}})(window.jQuery);